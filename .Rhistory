stringsAsFactors = FALSE) %>%
cbind(correlations)
flextable(correlations)
correlations = cor(nums)
correlations <- data.frame(
rowname = row.names(correlations),
stringsAsFactors = FALSE) %>%
cbind(correlations) %>%
mutate_if(is.numeric, round)
flextable(correlations)
correlations = cor(nums)
correlations <- data.frame(
rowname = row.names(correlations),
stringsAsFactors = FALSE) %>%
cbind(correlations) %>%
mutate_if(is.numeric, round(2))
correlations = cor(nums)
correlations <- data.frame(
rowname = row.names(correlations),
stringsAsFactors = FALSE) %>%
cbind(correlations) %>%
mutate_if(is.numeric, round,digits=2)
flextable(correlations)
f1 = flextable(correlations)
ft <- bg(f1, i = (: > 0.7) | (: < -0.7), j = ~ mpg, bg = "#EFEF99")
ft <- bg(ft, i = ~ abs(row.names(correlations)) < 3, j = ~ row.names(correlations), bg = "#EFEF99")
ft <- bg(f1, i = ~ abs(row.names(correlations)) < 3, j = ~ row.names(correlations), bg = "#EFEF99")
ft <- bg(ft, i = ~ row.names(correlations) > 0.7, j = ~ row.names(correlations), bg = "#EFEF99")
ft <- bg(f1, i = ~ row.names(correlations) > 0.7, j = ~ row.names(correlations), bg = "#EFEF99")
row.names(correlations)
ft <- bg(f1, i = ~. > 0.7, j = ~., bg = "#EFEF99")
ft <- bg(f1, i = ~ c('poor_fair_health','adult_smoking') > 0.7, j = row.names(correlations), bg = "#EFEF99")
ft <- bg(f1, i = ~ poor_fair_health > 0.7, j = row.names(correlations), bg = "#EFEF99")
ft
class(row.names(correlations))
ft <- bg(f1, i = ~ poor_fair_health > 0.7, j = c(row.names(correlations)), bg = "#EFEF99")
ft
ft <- bg(f1, i = ~ poor_fair_health > 0.7, j = ~ c(row.names(correlations)), bg = "#EFEF99")
ft = flextable(correlations) %>%
bold(i = row.names(correlations) > 0.7, j = row.names(correlations),bold=TRUE)
ft
ft = flextable(correlations) %>%
bold(i = poor_fair_health > 0.7, j = row.names(correlations),bold=TRUE)
ft = flextable(correlations) %>%
bold(i = ~ poor_fair_health > 0.7, j = row.names(correlations),bold=TRUE)
ft
correlations = cor(nums) %>%
mutate_if(is.numeric, round,digits=2)
correlations = cor(nums) %>%
apply(1, round, digits=2)
correlations
correlations[upper.tri(correlations)] <- NA # erase the upper triangle
diag(correlations) <- NA
correlations
correlations %>%
as.data.frame() %>%
rownames_to_column("var") %>%
flextable::flextable() %>%
flextable::bg(j = 2:ncol(correlations),
bg = function(x){
out <- rep("transparent", length(x))
out[x < -0.7 | x > 0.7] <- "light blue"
out
})
x_cts
b1 = master_data %>%
ggplot(aes(x=poor_fair_health, y=leading_party)) +
geom_boxplot()
b1
b1 = master_data %>%
ggplot(aes(x=c(x_cts), y=leading_party)) +
geom_boxplot()
b1
length(x_cts)
master_data[,x_cts][,1]
par(mfrow = c(2, 2))  # Set up a 2 x 2 plotting space
# Create the loop.vector (all the columns)
loop.vector <- 1:4
for (i in loop.vector) { # Loop over loop.vector
master_data %>% ggplot(aes(x=master_data[,x_cts][,i],
y=leading_party)) +
geom_boxplot() +
labs(x = x_cts[i],
y = "leading_party")
}
master_data[,x_cts][,1]
par(mfrow = c(2, 2))  # Set up a 2 x 2 plotting space
# Create the loop.vector (all the columns)
loop.vector <- 1:4
for (i in loop.vector) { # Loop over loop.vector
# store data in column.i as x
x <- master_data[,x_cts][,i]
# Plot histogram of x
hist(x)
}
master_data[,x_cts]
type(master_data[,x_cts])
types(master_data[,x_cts])
str(master_data[,x_cts])
loop.vector <- 1:2
for (i in loop.vector) { # Loop over loop.vector
# store data in column.i as x
x <- master_data[,x_cts][,i]
# Plot histogram of x
hist(x)
}
par(mfrow = c(1, 2))  # Set up a 2 x 2 plotting space
# Create the loop.vector (all the columns)
loop.vector <- 1:2
for (i in loop.vector) { # Loop over loop.vector
# store data in column.i as x
x <- master_data[,x_cts][,i]
# Plot histogram of x
print(x)
}
hist(master_data[,x_cts][,1])
hist(master_data$poor_fair_health)
master_data[,x_cts]$x_cts[1]
hist(master_data[,x_cts][[,1]])
class(master_data[,x_cts][,1])
class(master_data[,x_cts][[1]])
master_data[,x_cts][[1]]
par(mfrow = c(2, 2))  # Set up a 2 x 2 plotting space
# Create the loop.vector (all the columns)
loop.vector <- 1:4
for (i in loop.vector) { # Loop over loop.vector
# store data in column.i as x
x <- master_data[,x_cts][[i]]
# Plot histogram of x
hist(x)
}
x <- x_cts[1]
boxplot(x~leading_party,data=master_data)
x <- master_data[,x_cts][[1]]
boxplot(x~leading_party,data=master_data)
boxplot(leading_party~x,data=master_data, xlab=x_cts[1])
boxplot(leading_party~x,data=master_data)
boxplot(leading_party~x,data=master_data, xlab=x_cts[1], horizontal=TRUE)
hist1 = master_data %>%
ggplot(aes(x=poor_fair_health,color=leading_party)) +
geom_histogram()
hist1
hist1 = master_data %>%
ggplot(aes(x=poor_fair_health,color=leading_party)) +
geom_histogram(fill='white')
hist1
#boxplots between num. explanatory variables and cat. response variables
hist1 = master_data %>%
ggplot(aes(x=poor_fair_health,color=leading_party)) +
geom_histogram(fill='white',position='identity')
hist1
hist1 = ggplot(master_data, aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill="white", alpha=0.5, position="identity")
hist1
hist1 = ggplot(master_data, aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill=color, alpha=0.5, position="identity")
hist1
hist1 = ggplot(df, aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")
hist1 = ggplot(master_data, aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")
hist1
x_cts
health_hist = master_data %>%
ggplot(aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill="white", alpha=0.5, position="identity")
health_hist
health_hist = master_data %>%
ggplot(aes(x=poor_fair_health, color=leading_party)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")
health_hist
health_box = master_data %>%
ggplot(aes(x=poor_fair_health, y=leading_party)) +
geom_boxplot(horizontal=TRUE)
health_box
covid_box = master_data %>%
ggplot(aes(x=covid_deaths, y=leading_party)) +
geom_boxplot()
covid_box
covid_box = master_data %>%
ggplot(aes(x=pct_covid_deaths, y=leading_party)) +
geom_boxplot()
covid_box
master_data %>% select(pct_covid_deaths,covid_deaths,total_deaths)
master_data %>% select(sometimes, always, never)
mask_hist = master_data %>%
select(sometimes, always, never, leading_party) %>%
group_by(leading_party) %>%
summarise(mean_sometimes = mean(sometimes),
mean_always = mean(always),
mean_never = mean(never))
mask_hist
mask_hist = master_data %>%
select(sometimes, always, never, leading_party) %>%
group_by(leading_party) %>%
summarise(mean_sometimes = mean(sometimes),
mean_always = mean(always),
mean_never = mean(never)) %>%
ggplot(aes(x=mean_sometimes)) +
geom_bar(fill=leading_party)
x_cts
edu_box = master_data %>%
ggplot(aes(x=pct_bachelors_or_higher, y=leading_party)) +
geom_boxplot()
edu_box
income_box = master_data %>%
ggplot(aes(x=median_household_income, y=leading_party)) +
geom_boxplot()
income_box
unemp_box = master_data %>%
ggplot(aes(x=unemployment_rate, y=leading_party)) +
geom_boxplot()
unemp_box
race_box1 = master_data %>%
ggplot(aes(x=pct_nonhispanic_white, y=leading_party)) +
geom_boxplot()
race_box1
x_cts
race_box2 = master_data %>%
ggplot(aes(x=pct_nonhispanic_black, y=leading_party)) +
geom_boxplot()
race_box2
race_box3 = master_data %>%
ggplot(aes(x=pct_hispanic, y=leading_party)) +
geom_boxplot()
race_box3
race_box4 = master_data %>%
ggplot(aes(x=pct_asian, y=leading_party)) +
geom_boxplot()
race_box4
age_box = master_data %>%
ggplot(aes(x=pct_over_65, y=leading_party)) +
geom_boxplot()
age_box
age_box = master_data %>%
ggplot(aes(x=pct_above_65, y=leading_party)) +
geom_boxplot()
age_box
gender_box = master_data %>%
ggplot(aes(x=pct_females, y=leading_party)) +
geom_boxplot()
gender_box
v2_desc_cont
desc_cont
getwd()
x_cts
lpd <- master_data %>%
# Convert to long format
as_tibble() %>%
group_by(leading_party, urban_rural_desc) %>%
summarise(n())
lpd_sp <- ggplot(lpd, aes(x = leading_party, y = urban_rural_desc)) +
geom_point(aes(size = `n()`), shape = 21, colour = "black", fill = "cornsilk") +
scale_size_area(max_size = 20, guide = FALSE) +
geom_text(aes(label = `n()`),
vjust = 3.2,
colour = "grey60",
size = 4
) +
labs(x = 'Leading Party',
y = 'Urban/Rural Description',
title = 'County Type vs. Leading Party')
#save as image
ggsave(
filename = "results/urb-rural-lp.png",
plot = lpd_sp,
device = "png",
width = 7,
height = 9
)
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc, fill = leading_party) +
geom_bar(position='fill')
#save as image
ggsave(
filename = "results/desc-bar.png",
plot = desc_bar,
device = "png",
width = 9,
height = 9
)
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc, fill = leading_party) +
geom_bar(position='fill')
desc_bar + scale_color_manual(breaks = c("Democratic","Republican"),
values=c("blue", "red"))
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc, fill = leading_party) +
geom_bar(position='fill')
desc_bar + scale_color_manual(breaks = c("Democratic","Republican"),
values=c("blue", "red"))
desc_bar
save_as_image(desc_cont, path = "results/desc-cont.png")
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc) +
geom_bar()
desc_bar + scale_color_manual(breaks = c("Democratic","Republican"),
values=c("blue", "red"))
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc, fill = leading_party) +
geom_bar(position='fill')
desc_bar
desc_bar = master_data %>%
ggplot() +
aes(x = urban_rural_desc, fill = leading_party) +
geom_bar(position='fill') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
desc_bar
ggsave(
filename = "results/desc-bar.png",
plot = desc_bar,
device = "png",
width = 9,
height = 9
)
test <- chisq.test(master_data$leading_party, master_data$urban_rural_desc)
#save results
test_results = capture.output(print(test))
writeLines(test_results, con = file("results/chi2_output.txt"))
x_cts = x_cts[-1:-12]
#correlation matrix using corrplot
nums = master_data %>% select(x_cts)
corrMatrix = corrplot(cor(nums))
#focus on strongest correlations
correlations = cor(nums) %>%
apply(1, round, digits=2)
correlations[upper.tri(correlations)] <- NA # erase the upper triangle
diag(correlations) <- NA
correlations %>%
as.data.frame() %>%
rownames_to_column("var") %>%
flextable::flextable() %>%
flextable::bg(j = 2:ncol(correlations),
bg = function(x){
out <- rep("transparent", length(x))
out[x < -0.7 | x > 0.7] <- "light blue"
out
})
ggsave(
filename = "results/health-box.png",
plot = health_box,
device = "png",
width = 9,
height = 9
)
health_box = master_data %>%
ggplot(aes(x=poor_fair_health, y=leading_party)) +
geom_boxplot() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
health_box
health_box = master_data %>%
ggplot(aes(x=poor_fair_health, y=leading_party)) +
aes(fill=leading_party)
geom_boxplot() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
#health
health_box = master_data %>%
ggplot(aes(x=poor_fair_health, y=leading_party, fill=leading_party)) +
geom_boxplot() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
health_box
covid_box = master_data %>%
ggplot(aes(x=pct_covid_deaths, y=leading_party, fill=leading_party)) +
geom_boxplot() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
covid_box
mask_hist
mask_hist[1]
mask_hist[1,2]
mask_hist
mask1 = mask_hist %>%
ggplot(aes(x=mean_sometimes,y=leading_party,fill=leading_party)) +
geom_bar() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
mask1 = mask_hist %>%
ggplot(aes(x=mean_sometimes,fill=leading_party)) +
geom_bar() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
mask1 = mask_hist %>%
ggplot(aes(x=mean_sometimes,color=leading_party)) +
geom_bar() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
mask1 = mask_hist %>%
ggplot(aes(x=mean_sometimes,color=leading_party)) +
geom_bar(stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
ggplot(aes(x=leading_party,y=mean_sometimes,fill()=leading_party)) +
geom_bar(stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1 = mask_hist %>%
ggplot(fill=leading_party) +
geom_bar(aes(x=mean_sometimes,y=leading_party),stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
mask1 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_sometimes,y=leading_party,fill=leading_party),stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask1
mask2 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_always,y=leading_party,fill=leading_party),stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask3 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_never,y=leading_party,fill=leading_party),stat='identity') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask2
mask3
mask_behavior = plot_grid(mask1,mask2,mask3)
mask_behavior
plot_grid(race_box1,race_box2,race_box3,race_box4)
master_data$poor_fair_health
mask1 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_sometimes,y=leading_party,fill=leading_party),stat='identity') +
labs(x = 'Mean Proportion of Response "Sometimes"',
y = 'Leading Party') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask2 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_always,y=leading_party,fill=leading_party),stat='identity') +
labs(x = 'Mean Proportion of Response "Always"',
y = 'Leading Party') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask3 = mask_hist %>%
ggplot() +
geom_bar(aes(x=mean_never,y=leading_party,fill=leading_party),stat='identity') +
labs(x = 'Mean Proportion of Response "Never"',
y = 'Leading Party') +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
mask_behavior = plot_grid(mask1,mask2,mask3) +
labs(title = "How often do you wear a mask?")
mask_behavior
plot_row = plot_grid(mask1,mask2,mask3)
title = ggdraw() +
draw_label(
"How often do you wear a mask?",
fontface = 'bold',
x = 0,
hjust = 0
)
mask_behavior = plot_grid(title, plot_row)
mask_behavior
title = ggdraw() +
draw_label(
"How often do you wear a mask?",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
plot.margin = margin(0, 0, 0, 7))
mask_behavior = plot_grid(title, plot_row)
mask_behavior
ggsave(
filename = "results/mask-bar.png",
plot = mask_behavior,
device = "png",
width = 9,
height = 9
)
ggsave(
filename = "results/mask-bar.png",
plot = mask_behavior,
device = "png",
width = 15,
height = 9
)
ggsave(
filename = "results/mask-bar.png",
plot = mask_behavior,
device = "png",
width = 20,
height = 9
)
master_data$pct_bachelors_or_higher
unemp_box = master_data %>%
ggplot(aes(x=unemployment_rate, y=leading_party, fill=leading_party)) +
geom_boxplot() +
scale_fill_manual(breaks = c("Democrat", "Republican"),
values = c("blue", "red"))
master_data$unemployment_rate
